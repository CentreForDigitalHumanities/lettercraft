<lc-breadcrumb [breadcrumbs]="breadcrumbs" />

<h1 class="mb-4">Source texts</h1>

<p>
    The list below shows the medieval texts that have been analysed in the
    Lettercraft project. Click on a source to view more information and explore
    its epistolary events.
</p>

<p>
    Use the search box to filter the list of sources by name, author, editor or title.
</p>

<ng-container *ngIf="data$ | async as data">
    <div class="input-group mb-3 mt-4">
        <span class="input-group-text">
            <div
                *ngIf="loading$ | async; else notLoading"
                class="spinner-border spinner-border-sm"
                role="status"
            >
                <span class="visually-hidden">Searching sources...</span>
            </div>
            <ng-template #notLoading>
                <lc-icon [icon]="actionIcons.search" />
            </ng-template>
        </span>
        <input
            type="text"
            class="form-control"
            placeholder="Search sources..."
            [formControl]="searchControl"
        />
        <button
            class="btn btn-outline-secondary"
            type="button"
            (click)="clearSearch()"
            [disabled]="searchControl.value === ''"
        >
            <lc-icon [icon]="actionIcons.cancel" />
            Clear search
        </button>
    </div>

    <ul class="list-group mt-2">
        <li
            *ngFor="let source of data.sources"
            class="list-group-item list-group-item-action"
        >
            <div class="d-flex align-items-center">
                <a [routerLink]="[source.id]" class="mb-1 h5 stretched-link">{{ source.name }}</a>
                <small class="text-body-secondary ms-2">
                    ({source.numOfEpisodes, plural, =0 {No episodes} =1 {1 episode} other {{{ source.numOfEpisodes}} episodes}})
                </small>
            </div>
            <p class="mb-1">
                <ng-container *ngIf="source.medievalAuthor || source.medievalTitle">
                    {{ source.medievalAuthor }}<ng-container *ngIf="source.medievalAuthor && source.medievalTitle">, </ng-container><em>{{ source.medievalTitle }}</em>.
                </ng-container>
                <ng-container *ngIf="source.editionAuthor || source.editionTitle">
                    (Ed. {{ source.editionAuthor }}<ng-container *ngIf="source.editionAuthor && source.editionTitle">, </ng-container><em>{{ source.editionTitle }}</em>.)
                </ng-container>
            </p>
        </li>
    </ul>

    <div *ngIf="data.sources.length === 0" class="mt-3 text-center">
        <p class="text-muted">No sources found matching "{{ searchControl.value }}"</p>
    </div>
</ng-container>
